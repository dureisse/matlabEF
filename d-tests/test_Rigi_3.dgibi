* Idem test_Rigi_1 mais avec un champ plus complique
OPTI DIME 2 ELEM QUA4;
OPTI MODE PLAN CONT;
P1 = 0. 0.; P2 = 1. 0.; P3 = 0. 1.;
L1 = P1 D 3 P2;
M1 = L1 TRAN 2 P3;

* On passe en TRI3
M1 = M1 CHAN TRI3;
* On passe en TRI6
M1 = M1 CHAN TRI6;

X Y = COOR M1;
X = (X ** 3) + Y;
Y = Y - X;
C1 = (EXCO SCAL X UX NATURE DIFFUS) ET
     (EXCO SCAL Y UY NATURE DIFFUS);

MODL1 = MODE M1 MECANIQUE ELASTIQUE;
MATR1 = MATE MODL1 YOUNG 1. NU 0.3;
RIGI1 = RIGI MODL1 MATR1;
XVAL1 = XTMX C1 RIGI1;
list (XVAL1);
list (XVAL1 - 2.2847985347);
MESS 'XVAL1' XVAL1;

SIGM1 = (MANU CHAM MODL1 TYPE CONTRAINTES POSI STRESSES SMXX 1 1 1 0.)
 ET     (MANU CHAM MODL1 TYPE CONTRAINTES POSI STRESSES SMYY 1 1 1 1.)
 ET     (MANU CHAM MODL1 TYPE CONTRAINTES POSI STRESSES SMXY 1 1 1 0.)
 ET     (MANU CHAM MODL1 TYPE CONTRAINTES POSI STRESSES SMZZ 1 1 1 0.);
FSIG1 = BSIGMA MODL1 SIGM1;
C1 = C1 ET (CHAN ATTRIBUT FSIG1 NATURE DIFFUS);

OPTI SORT 'test_Rigi_3';
SORT AVS M1 C1 MATR1;
OPTI SORT 'poub';

FIN;
