* Test sur une surface plong√©e en 3D
OPTI DIME 2 ELEM TRI3;
P1 = 0. 0.;
P2 = 0. 1.;
P3 = 1. 0.;

TEST1 = 1;
TEST1 = 2;
TEST1 = 3;



SI (EGA TEST1 1);
* Plan z = 0
  OPTI DIME 2 ELEM TRI3;
  OPTI DIME 2 ELEM QUA4;
  LI1 = P1 D 5 P2;
  SURF1 = LI1 TRAN 5 P3;
  OPTI DIME 3 ELEM TRI3;
  OPTI DIME 3 ELEM QUA4;
SINON; SI (EGA TEST1 2);
  LI1 = CERC 5 P2 P1 P3;
  OPTI DIME 3 ELEM TRI3;
  OPTI DIME 3 ELEM QUA4;
  P4 = 0. 0. 1.;
  SURF1 = LI1 TRAN 5 P4;
SINON; SI (EGA TEST1 3);
  LI1 = CERC 100 P2 P1 P3;
  OPTI DIME 3 ELEM TRI3;
  OPTI DIME 3 ELEM QUA4;
  P4 = 0. 0. 1.;
  SURF1 = LI1 TRAN 100 P4;
  Z1 = COOR 3 SURF1;
  UU1 = EXCO SCAL (Z1 ** 2) UX NATURE DIFFUS;
  UU1 = (0.2 / (MAXI UU1)) * UU1;
  SURF1 = SURF1 PLUS UU1;
FINSI;
FINSI;
FINSI;

VEC1 = 0.1 0.1 0.1;
SURF1 = ORIENTER SURF1 DIRECTION VEC1;

SI (1 EGA 0);
* IL faut orienter la surface
  MM1 = MODE SURF1 MECANIQUE ELASTIQUE;
  MM1 = MODE SURF1 CHARGEMENT PRESSION;
  CHEL1 = MANU 'CHML' SURF1 'SCAL' 1.;
  CHEL1 = MANU 'CHML' MM1 'SCAL' 1.;
  FF1 = PRESS MM1 CHEL1;
FINSI;
SI (1 EGA 0);
  MM1 = MODE SURF1 MECANIQUE ELASTIQUE DKT;
  CHAM1 = VSUR MM1;
FINSI;

X1 Y1 Z1 = COOR SURF1;
U1 = (EXCO SCAL (0.2 * X1) UX NATURE DIFFUS) ET
     (EXCO SCAL (0.2 * X1) UY NATURE DIFFUS) ET
     (EXCO SCAL ((0.2 * Y1) - (0.1 * X1)) UZ NATURE DIFFUS);

* Translation sur z
U1 = MANU CHPO SURF1 3 UX 0. UY 0. UZ 1. NATURE DIFFUS;

* Pression pour valider
OPTI DIME 3 ELEM PRI6;
OPTI DIME 3 ELEM CUB8;
VOL1 = SURF1 VOLU TRAN 1 VEC1;
MO1 = MODE VOL1 MECANIQUE ELASTIQUE;
P1 = PRESS MASS MO1 1. SURF1; 
P1 = CHAN 'ATTRIBUT' P1 NATURE DIFFUS;
CHP1 = U1 ET P1;

OPTI SORT 'test_NansonFreeNDS.inp';
SORT 'AVS' SURF1 CHP1;
OPTI SORT 'poub';

FIN;

